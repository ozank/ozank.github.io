<!DOCTYPE html>
<html>
  <head>
    <title>EE464-Static Power Conversion-II</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <style type="text/css">
      @import url(http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(http://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
    </style>
  </head>
  <body>
    <textarea id="source">

class: center, middle

# EE-464 STATIC POWER CONVERSION-II

# Other PWM Techniques

## Ozan Keysan

## [keysan.me](http://keysan.me)

### Office: C-113 <span class="meta">&#8226;</span> Tel: 210 7586

---

# Hysteresis (Bang-Bang) PWM
--

## You already implemented in the first semester

<img src="./images/ee464/hysteresis_pwm.png" alt="Drawing" style="width: 600px;">

---

# Hysteresis (Bang-Bang) PWM

### If your current is higher than your reference, reduce the current (switch off), if not increase the current (Switch ON)

<img src="./images/ee464/hysteresis_pwm.png" alt="Drawing" style="width: 600px;">

---

# Hysteresis (Bang-Bang) PWM

### For an inverter, just change your reference current to a sinusoidal waveform instead of a constant reference.

<img src="./images/ee464/hysteresis_pwm2.png" alt="Drawing" style="width: 500px;">

---

# Hysteresis (Bang-Bang) PWM
--

- ## The switching frequency is varying
--

- ## Difficult to design filter (because of varying fs)
--

- ## Can induce side-band harmonics
--

- ## Simple control and implementation

---

# Hysteresis (Bang-Bang) PWM


<img src="https://www.researchgate.net/profile/Michal_Knapczyk/publication/228659032/figure/fig3/AS:393882949963776@1470920421181/The-idea-and-control-signals-of-Hysteresis-Band-PWM.png" alt="Drawing" style="width: 550px;">

---
# Field Oriented Control (FOC)
--

<img src="https://www.roboteq.com/images/article-images/how-to/image014.png" alt="Drawing" style="width: 550px;">

- ### [What is FOC?](https://www.youtube.com/watch?v=Nhy6g9wGHow)
- ### [Field oriented Control of PM Motors](https://www.youtube.com/watch?v=cdiZUszYLiA)
---

## How to aim to a moving target?
--

<img src="https://cdn.shopify.com/s/files/1/0264/5540/8674/files/carrot_and_donkey_large.jpg" alt="Drawing" style="width: 600px;">


---
# A Few Useful Mathematical Tools
--

- ## Clarke Transformation
- ## Park Transformation


---
# [Clarke](https://en.wikipedia.org/wiki/Edith_Clarke) Transformation
## (a-b-c) to \\(\alpha \beta \\) Transformation

## From three-phase to two orthogonal phase transformation
--

### Main Idea: In a balanced three-phase system, \\(I_a + I_b + I_c =0\\)  so there is redundant information and system can be reduced to two variables.

---
##How do you define the resultant (black) phasor?


<img src="./images/rotating_mmf_phasor2.gif" alt="Drawing" style="width: 800px;">

---
# Clarke Transformation

<img src="https://www.keil.com/pack/doc/CMSIS/DSP/html/clarke.gif" alt="Drawing" style="width: 600px;"/>

---
# Clarke Transformation

<img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/36e05ba56ec15de753eb9f3c60983bc874e31370" alt="Drawing" style="width: 750px;"/>
---
# Park Transformation
## (or D-Q Transformation)

---
# Park Transformation in Space

<iframe width="700" height="400" src="https://www.youtube-nocookie.com/embed/c4tPQYNpW9k" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


### i.e. [Interstellar - Docking Scene](https://www.youtube.com/watch?v=c4tPQYNpW9k)

---
# Park Transformation
--

## From rotating frame to stationary frame
--

## Instead of dealing with sinusoidal signals, just  use the magnitudes.
--

## When re-constructing signals use the rotor position information



---
# Park Transformation

<img src="https://static1.squarespace.com/static/584729023e00bebf8abd6ba0/t/58664f0f2994ca78b5145f29/1483099927549/?format=750w" alt="Drawing" style="width: 750px;"/>

---
# Park Transformation
--

<img src="./images/ee462/park_transform.png" alt="Drawing" style="width: 400px;"/>
--

## \\(I\_d = I\_\alpha  cos(\theta) + I\_\beta sin (\theta)\\)
--

## \\(I\_q = I\_\beta  cos(\theta) - I\_\alpha sin (\theta)\\)
--


---
## Reference Frames

<img src="./images/ee462/reference_frames.png" alt="Drawing" style="width: 750px;"/>
---
## Clarke and Park Transformations

<img src="https://static1.squarespace.com/static/584729023e00bebf8abd6ba0/t/5866535e414fb5c4d35ed4cb/1483101083243/ClarkePark_Animation?format=500w" alt="Drawing" style="width: 500px;"/>
---
# Torque and Flux Control

# Id: Proportional to flux in the air-gap


# Iq: Proportional to torque generated


---
# Inverse Transforms
--

## Required to apply reference voltage and current waveforms (sinusoidals)
--

- ## Inverse Park Transform
- ## Inverse Clarke Transform


---
# Inverse Park Transform
--

## From rotation frame to stationary frame
--


## \\(I\_\alpha = I\_d  cos(\theta) - I\_q sin (\theta)\\)
--

## \\(I\_\beta = I\_q  cos(\theta) + I\_d sin (\theta)\\)

---

## Inverse Clarke Transform

### From two-axis orthogonal plane to 3-phase stationary frame.

<img src="http://e2e.ti.com/cfs-file/__key/communityserver-discussions-components-files/171/3750._F764D653_.JPG" alt="Drawing" style="width: 500px;"/>

---
## Whole Workflow

<img src="https://static1.squarespace.com/static/584729023e00bebf8abd6ba0/t/58c88acd579fb3efb64797c9/1489537751460/?format=1000w" alt="Drawing" style="width: 750px;"/>

<img src="./images/ee464/foc_workflow.png" alt="Drawing" style="width: 600px;"/>

---
# Classical Vector Control Diagram

<img src="http://3l4sbp4ao2771ln0f54chhvm.wpengine.netdna-cdn.com/wp-content/uploads/2016/07/Vector-Block-Diagram.gif" alt="Drawing" style="width: 600px;"/>

---
# Vector Control in PMSM

<img src="http://www.mdpi.com/sensors/sensors-17-00973/article_deploy/html/images/sensors-17-00973-g007.png" alt="Drawing" style="width: 750px;"/>

---
# Vector Control in Induction Motors


<img src="https://www.mathworks.com/help/physmod/sps/powersys/ug/electric_drives223.gif" alt="Drawing" style="width: 700px;"/>
---
# Summary

<img src="./images/ee464/donkey.png" alt="Drawing" style="width: 600px;"/>

---

# Further Reading

### [Vector Control for Dummies](https://www.switchcraft.org/learning/2016/12/16/vector-control-for-dummies)

### [What is Field Oriented Control?](https://www.eetimes.com/document.asp?doc_id=1279321)

### [Field Oriented Control](http://mycourses.aalto.fi/pluginfile.php/1055633/mod_resource/content/12/Lecture10.pdf)

### [Field Oriented Control of AC Motors](http://www.ti.com/lit/an/bpra073/bpra073.pdf)

### [Sensorless PMSM Field Oriented Control](http://cache.nxp.com/assets/documents/data/en/reference-manuals/DRM148.pdf)

### [Space Vector PWM](https://www.switchcraft.org/learning/2017/3/15/space-vector-pwm-intro)
---

# 3-Phase Two-Level Inverter
--

<img src="./images/ee464/two_level_vsi.png" alt="Drawing" style="width: 800px;">

### Anti-parallel diodes are not shown.

---

# 3-Phase Two-Level Inverter

<img src="./images/ee464/two_level_vsi_simple.png" alt="Drawing" style="width: 800px;">

## Each leg has two positions: 
--
top switch closed (1)

---

# 3-Phase Two-Level Inverter

<img src="./images/ee464/two_level_vsi_simple.png" alt="Drawing" style="width: 800px;">

## Each leg has two positions: 
--
bottom switch closed (0)

---

# [Voltage Vectors](https://www.switchcraft.org/learning/2017/3/15/space-vector-pwm-intro)
--

<img src="./images/ee464/voltage_vectors.png" alt="Drawing" style="width: 600px;">


---

### 000 - \\(v_0\\) (zero vector)
### 001 - \\(v_1\\) (Phase +U)
### 010 - \\(v_2\\) (Phase +V)
### 011 - \\(v_3\\) (Phase -W)
### 100 - \\(v_4\\) (Phase +W)
### 101 - \\(v_5\\) (Phase -V)
### 110 - \\(v_6\\) (Phase -U)
### 111 - \\(v_7\\) (zero vector)

---
# Voltage Vectors: V0

<img src="./images/ee464/v0.png" alt="Drawing" style="width: 750px;">

---
# Voltage Vectors: V1

<img src="./images/ee464/v1.png" alt="Drawing" style="width: 750px;">

---
# Voltage Vectors: V2

<img src="./images/ee464/v2.png" alt="Drawing" style="width: 750px;">

---
# Voltage Vectors: V3

<img src="./images/ee464/v3.png" alt="Drawing" style="width: 750px;">

---
# Voltage Vectors: V4

<img src="./images/ee464/v4.png" alt="Drawing" style="width: 750px;">

---
# Voltage Vectors: V5

<img src="./images/ee464/v5.png" alt="Drawing" style="width: 750px;">

---
# Voltage Vectors: V6

<img src="./images/ee464/v6.png" alt="Drawing" style="width: 750px;">

---
# Voltage Vectors: V7

<img src="./images/ee464/v7.png" alt="Drawing" style="width: 750px;">

---

# Square Wave Operation



<img src="https://media.giphy.com/media/aFdKsSmSHbLtC/giphy.gif" alt="Drawing" style="width: 800px;">


### [BLDC Drive with square wave](https://www.youtube.com/watch?v=IiY01xIKg28)

---

## What about the vectors in between?
--

<img src="./images/rotating_mmf_sine.gif" alt="Drawing" style="width: 750px;">

---

## What about the vectors in between?

<img src="./images/rotating_mmf_phasor.gif" alt="Drawing" style="width: 600px;">


---

## What about the vectors in between?


<img src="./images/rotating_mmf_phasor2.gif" alt="Drawing" style="width: 800px;">

---
# Voltage Synthesizing

<img src="https://static1.squarespace.com/static/584729023e00bebf8abd6ba0/t/58fea6c8ebbd1a25ce89c905/1494287982183/Basic-Vectors-with-reference.png?format=500w" alt="Drawing" style="width: 500px;"/>
---
# Voltage Synthesizing

<img src="https://static1.squarespace.com/static/584729023e00bebf8abd6ba0/58fea923197aea4f7f28f61a/58fea9286a49632401d63e94/1493084598485/SVPWM-1.png?format=1000w" alt="Drawing" style="width: 700px;"/>
---
# PWM Generation

<img src="https://static1.squarespace.com/static/584729023e00bebf8abd6ba0/t/59110ff0ebbd1a1c7143886d/1494290426838/?format=1000w" alt="Drawing" style="width: 700px;"/>
---
# PWM Generation

<img src="https://static1.squarespace.com/static/584729023e00bebf8abd6ba0/t/59111028c534a5947d523098/1494290481944/?format=1000w" alt="Drawing" style="width: 550px;"/>

### Switching Sequence: 000-001-011-111
---
# PWM Generation

## Switching Sequence:

- ## Zero Vector (000)
--

- ## Basic Vector (i.e. 001)
--

- ## Basic Vector (i.e. 011)
--

- ## Zero Vector (i.e. 111)
--

## Only one switch position is changed at each step!

---
# PWM Generation

<img src="https://static1.squarespace.com/static/584729023e00bebf8abd6ba0/t/58feacf5d482e9da38497463/1493085606567/?format=1000w" alt="Drawing" style="width: 700px;"/>
---

## SPWM vs SVPWM
--

<img src="./images/ee464/spwm_svpwm.png" alt="Drawing" style="width: 450px;">

#### Phase Voltages
---


## SPWM vs SVPWM
--

- ## Space Vector PWM generates less harmonic distortion
--

- ##  Space Vector PWM utilizes input voltage more \\(1/2\\) vs \\(1/\sqrt{3}\\) (15% more)



---
### What is the max. possible phase voltage with SPWM (Sinusoidal PWM)?
--

<img src="./images/ee464/spwm.jpg" alt="Drawing" style="width: 400px;"/>
--

### \\(\hat{V}\_{p-n}=\dfrac{V\_{DC}}{2}\\)

---
### What is the max. possible phase voltage with SPWM (Sinusoidal PWM)?
--

### The inverter is connected to 400 \\(V\_{l-l}\\) grid with a 3-ph diode rectifier:

<img src="./images/ee464/vfd.jpg" alt="Drawing" style="width: 500px;"/>
--

### \\(V\_{DC}=\\)
--
\\(\dfrac{3\sqrt{2}}{\pi} V\_{l-l} \\)
--
\\(= 1.35 V\_{l-l} = 540 V\\)

---
### What is the max. possible phase voltage with SPWM (Sinusoidal PWM)?
--

<img src="./images/ee464/vfd.jpg" alt="Drawing" style="width: 500px;"/>
--

### Maximum motor phase voltage:
--

### \\( V\_{phase-rms} = \dfrac{V\_{DC}}{2 \sqrt{2}}= 190 V\\)

### which is quite low for standard motors!

---
## How can you increase the output voltage beyond the DC-link voltage limit?
--

<img src="https://images3.memedroid.com/images/UPLOADED950/5bbcb4de55956.jpeg" alt="Drawing" style="width: 400px;"/>

---
# Third Harmonic Injection (THIPWM)

--

### A sinusoidal reference voltage output: 

<img src="https://static1.squarespace.com/static/584729023e00bebf8abd6ba0/t/590687ddff7c50866d9f4f1d/1493600229378/?format=1000w" alt="Drawing" style="width: 800px;"/>


---
# Third Harmonic Injection (THIPWM)

### Assume you apply a waveform like that:

<img src="https://static1.squarespace.com/static/584729023e00bebf8abd6ba0/t/59068b67725e256add1f37f5/1493601135313/?format=1000w" alt="Drawing" style="width: 800px;"/>

### which composes of the fundamental and a third-harmonic component

---
# Third Harmonic Injection (THIPWM)

### Such that \\(V = \dfrac{V\_{DC}}{2}\\) at \\(\pi/3\\)
<img src="https://static1.squarespace.com/static/584729023e00bebf8abd6ba0/t/59068e15e6f2e142b4adbe4f/1493601820281/?format=1000w" alt="Drawing" style="width: 800px;"/>
---

# Third Harmonic Injection (THIPWM)

### What is the phase voltage?

<img src="https://static1.squarespace.com/static/584729023e00bebf8abd6ba0/t/590691aed1758ec4d7664141/1493602742473/ThirdHarmonics.png?format=500w" alt="Drawing" style="width: 500px;"/>

#### Third harmonic cancels itself (common-mode voltage), the potential of the neutral votlage is oscillating, but the winding doesn't see this change and observe a pure sinusoidal.


---
# Third Harmonic Injection (THIPWM)

### What is the phase voltage?


### THIPWM: \\( V\_{phase-rms} = \dfrac{V\_{DC}}{ \sqrt{6}}= 220 V\\)

--
### %15 higher than SPWM
###  ( \\( V\_{phase-rms} = \dfrac{V\_{DC}}{2 \sqrt{2}}= 190 V\\)) 

---
# Third Harmonic Injection (THIPWM)

<img src="./images/ee462/thipwm.gif" alt="Drawing" style="width: 800px;"/>

---
## How about SVPWM?
--

### What is the phase voltage for one of the SVPWM vectors?
--

### \\(\hat{V\_n} = \dfrac{2}{3}V\_{DC}\\)
--

### What if two adjacent vectors are applied  for %50, %50?
--

### \\(= \dfrac{2}{3}V\_{DC} \dfrac{\sqrt{3}}{2} = \dfrac{1}{\sqrt{3}}V\_{DC}\\) 

### Same with THIPWM: \\(V\_{ph,rms}=  \dfrac{1}{\sqrt{6}}V\_{DC} = 220 V\\)

---
## How about SVPWM?


### Magnitude comparison of SPWM and SVPWM

<img src="./images/ee464/svpwm_locus.png" alt="Drawing" style="width: 500px;"/>

---

### Magnitude comparison of SPWM and SVPWM

### Space Vector (SVPWM)

### Max. \\(V\_{l-l,rms} = \sqrt{3} \dfrac{\frac{V\_{dc}}{\sqrt{3}}}{\sqrt{2}}\\)
--
\\(= \dfrac{V\_{dc}}{\sqrt{2}} = 0.707 V\_{dc}\\)

--

### Sinusoidal (SPWM)
--

### Max. \\(V\_{l-l,rms} = \sqrt{3} \dfrac{\frac{V\_{dc}}{2}}{\sqrt{2}}\\)
--
\\(= \dfrac{ \sqrt{3} V\_{dc}}{2\sqrt{2}} = 0.612 V\_{dc}\\)

### SVPWM is %15 higher than SPWM

---
## You can download this presentation from: [keysan.me/ee464](http://keysan.me/ee464)


    </textarea>
    <script src="http://gnab.github.io/remark/downloads/remark-latest.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML&delayStartupUntil=configured" type="text/javascript"></script>
    <script type="text/javascript">
      var slideshow = remark.create({countIncrementalSlides: false});

      // Setup MathJax
      MathJax.Hub.Config({
          tex2jax: {
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
          }
      });
      MathJax.Hub.Queue(function() {
          $(MathJax.Hub.getAllJax()).map(function(index, elem) {
              return(elem.SourceElement());
          }).parent().addClass('has-jax');
      });

      MathJax.Hub.Configured();
    </script>
  </body>
</html>
